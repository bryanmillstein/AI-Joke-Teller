!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){"use strict";function Voice(){this.voice="en-US_AllisonVoice",this.audio=$(".audio").get(0)}module.exports=Voice,Voice.prototype.synthesizeRequest=function(text){var sessionPermissions=JSON.parse(localStorage.getItem("sessionPermissions"))?0:1,downloadURL="/api/synthesize?voice="+this.voice+"&text="+encodeURIComponent(text)+"&X-WDC-PL-OPT-OUT="+sessionPermissions;this.audio.pause();try{this.audio.currentTime=0}catch(ex){}return this.audio.src=downloadURL,this.audio.play(),this.audio.addEventListener("ended",function(){$("#hold-span").css("display","initial")}),!0}},{}],2:[function(require,module){"use strict";function Microphone(_options){var options=_options||{};this.bufferSize=options.bufferSize||8192,this.inputChannels=options.inputChannels||1,this.outputChannels=options.outputChannels||1,this.recording=!1,this.requestedAccess=!1,this.sampleRate=16e3,this.bufferUnusedSamples=new Float32Array(0),this.samplesAll=new Float32Array(2e7),this.samplesAllOffset=0,navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)}var utils=require("./utils");Microphone.prototype.onPermissionRejected=function(){console.log("Microphone.onPermissionRejected()"),this.requestedAccess=!1,this.onError("Permission to access the microphone rejeted.")},Microphone.prototype.onError=function(error){console.log("Microphone.onError():",error)},Microphone.prototype.onMediaStream=function(stream){var AudioCtx=window.AudioContext||window.webkitAudioContext;if(!AudioCtx)throw new Error("AudioContext not available");this.audioContext||(this.audioContext=new AudioCtx);var gain=this.audioContext.createGain(),audioInput=this.audioContext.createMediaStreamSource(stream);audioInput.connect(gain),this.mic||(this.mic=this.audioContext.createScriptProcessor(this.bufferSize,this.inputChannels,this.outputChannels)),console.log("Microphone.onMediaStream(): sampling rate is:",this.sampleRate),this.mic.onaudioprocess=this._onaudioprocess.bind(this),this.stream=stream,gain.connect(this.mic),this.mic.connect(this.audioContext.destination),this.recording=!0,this.requestedAccess=!1,this.onStartRecording()},Microphone.prototype._onaudioprocess=function(data){if(this.recording){var chan=data.inputBuffer.getChannelData(0);this.saveData(new Float32Array(chan)),this.onAudio(this._exportDataBufferTo16Khz(new Float32Array(chan)))}},Microphone.prototype.record=function(){return navigator.getUserMedia?void(this.requestedAccess||(this.requestedAccess=!0,navigator.getUserMedia({audio:!0},this.onMediaStream.bind(this),this.onPermissionRejected.bind(this)))):void this.onError("Browser doesn't support microphone input")},Microphone.prototype.stop=function(){console.log(this),this.recording&&(JSON.parse(localStorage.getItem("playback"))&&this.playWav(),this.recording=!1,this.stream.getTracks()[0].stop(),this.requestedAccess=!1,this.mic.disconnect(0),this.onStopRecording())},Microphone.prototype._exportDataBufferTo16Khz=function(bufferNewSamples){var buffer=null,newSamples=bufferNewSamples.length,unusedSamples=this.bufferUnusedSamples.length;if(unusedSamples>0){buffer=new Float32Array(unusedSamples+newSamples);for(var i=0;unusedSamples>i;++i)buffer[i]=this.bufferUnusedSamples[i];for(i=0;newSamples>i;++i)buffer[unusedSamples+i]=bufferNewSamples[i]}else buffer=bufferNewSamples;for(var filter=[-.037935,-89024e-8,.040173,.019989,.0047792,-.058675,-.056487,-.0040653,.14527,.26927,.33913,.26927,.14527,-.0040653,-.056487,-.058675,.0047792,.019989,.040173,-89024e-8,-.037935],samplingRateRatio=this.audioContext.sampleRate/16e3,nOutputSamples=Math.floor((buffer.length-filter.length)/samplingRateRatio)+1,pcmEncodedBuffer16k=new ArrayBuffer(2*nOutputSamples),dataView16k=new DataView(pcmEncodedBuffer16k),index=0,volume=32767,nOut=0,i=0;i+filter.length-1<buffer.length;i=Math.round(samplingRateRatio*nOut)){for(var sample=0,j=0;j<filter.length;++j)sample+=buffer[i+j]*filter[j];sample*=volume,dataView16k.setInt16(index,sample,!0),index+=2,nOut++}var indexSampleAfterLastUsed=Math.round(samplingRateRatio*nOut),remaining=buffer.length-indexSampleAfterLastUsed;if(remaining>0)for(this.bufferUnusedSamples=new Float32Array(remaining),i=0;remaining>i;++i)this.bufferUnusedSamples[i]=buffer[indexSampleAfterLastUsed+i];else this.bufferUnusedSamples=new Float32Array(0);return new Blob([dataView16k],{type:"audio/l16"})};Microphone.prototype._exportDataBuffer=function(buffer){utils.exportDataBuffer(buffer,this.bufferSize)},Microphone.prototype.onStartRecording=function(){},Microphone.prototype.onStopRecording=function(){},Microphone.prototype.onAudio=function(){},module.exports=Microphone,Microphone.prototype.saveData=function(samples){for(var i=0;i<samples.length;++i)this.samplesAll[this.samplesAllOffset+i]=samples[i];this.samplesAllOffset+=samples.length},Microphone.prototype.playWav=function(){var samples=this.samplesAll.subarray(0,this.samplesAllOffset),dataview=this.encodeWav(samples,1,this.audioContext.sampleRate),audioBlob=new Blob([dataview],{type:"audio/l16"}),url=window.URL.createObjectURL(audioBlob),audio=new Audio;audio.src=url,audio.play()},Microphone.prototype.encodeWav=function(samples,numChannels,sampleRate){console.log("#samples: "+samples.length);var buffer=new ArrayBuffer(44+2*samples.length),view=new DataView(buffer);return this.writeString(view,0,"RIFF"),view.setUint32(4,36+2*samples.length,!0),this.writeString(view,8,"WAVE"),this.writeString(view,12,"fmt "),view.setUint32(16,16,!0),view.setUint16(20,1,!0),view.setUint16(22,numChannels,!0),view.setUint32(24,sampleRate,!0),view.setUint32(28,4*sampleRate,!0),view.setUint16(32,2*numChannels,!0),view.setUint16(34,16,!0),this.writeString(view,36,"data"),view.setUint32(40,2*samples.length,!0),this.floatTo16BitPCM(view,44,samples),view},Microphone.prototype.writeString=function(view,offset,string){for(var i=0;i<string.length;i++)view.setUint8(offset+i,string.charCodeAt(i))},Microphone.prototype.floatTo16BitPCM=function(output,offset,input){for(var i=0;i<input.length;i++,offset+=2){var s=Math.max(-1,Math.min(1,input[i]));output.setInt16(offset,0>s?32768*s:32767*s,!0)}}},{"./utils":11}],3:[function(require,module){module.exports={models:[{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/ar-AR_BroadbandModel",rate:16e3,name:"ar-AR_BroadbandModel",language:"ar-AR",description:"Modern Standard Arabic broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/en-UK_BroadbandModel",rate:16e3,name:"en-UK_BroadbandModel",language:"en-UK",description:"UK English broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/en-UK_NarrowbandModel",rate:8e3,name:"en-UK_NarrowbandModel",language:"en-UK",description:"UK English narrowband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/en-US_BroadbandModel",rate:16e3,name:"en-US_BroadbandModel",language:"en-US",description:"US English broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/en-US_NarrowbandModel",rate:8e3,name:"en-US_NarrowbandModel",language:"en-US",description:"US English narrowband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/es-ES_BroadbandModel",rate:16e3,name:"es-ES_BroadbandModel",language:"es-ES",description:"Spanish broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/es-ES_NarrowbandModel",rate:8e3,name:"es-ES_NarrowbandModel",language:"es-ES",description:"Spanish narrowband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/ja-JP_BroadbandModel",rate:16e3,name:"ja-JP_BroadbandModel",language:"ja-JP",description:"Japanese broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/ja-JP_NarrowbandModel",rate:8e3,name:"ja-JP_NarrowbandModel",language:"ja-JP",description:"Japanese narrowband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/pt-BR_BroadbandModel",rate:16e3,name:"pt-BR_BroadbandModel",language:"pt-BR",description:"Brazilian Portuguese broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/pt-BR_NarrowbandModel",rate:8e3,name:"pt-BR_NarrowbandModel",language:"pt-BR",description:"Brazilian Portuguese narrowband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/zh-CN_BroadbandModel",rate:16e3,name:"zh-CN_BroadbandModel",language:"zh-CN",description:"Mandarin broadband model."},{url:"https://stream.watsonplatform.net/speech-to-text/api/v1/models/zh-CN_NarrowbandModel",rate:8e3,name:"zh-CN_NarrowbandModel",language:"zh-CN",description:"Mandarin narrowband model."}]}},{}],4:[function(require,module,exports){"use strict";function updateTextScroll(){if(!scrolled){$("#resultsText").get(0)}}function updateScroll(){if(!scrolled){var element=$(".table-scroll").get(0);element.scrollTop=element.scrollHeight}}var scrolled=!1,textScrolled=!1,showTimestamp=function(timestamps,confidences){var word=timestamps[0],t0=timestamps[1],t1=timestamps[2],displayConfidence=confidences?confidences[1].toString().substring(0,3):"n/a";$("#metadataTable > tbody:last-child").append("<tr><td>"+word+"</td><td>"+t0+"</td><td>"+t1+"</td><td>"+displayConfidence+"</td></tr>")},showMetaData=function(alternative){var confidenceNestedArray=alternative.word_confidence,timestampNestedArray=alternative.timestamps;if(confidenceNestedArray&&confidenceNestedArray.length>0)for(var i=0;i<confidenceNestedArray.length;i++){var timestamps=timestampNestedArray[i],confidences=confidenceNestedArray[i];showTimestamp(timestamps,confidences)}else timestampNestedArray&&timestampNestedArray.length>0&&timestampNestedArray.forEach(function(timestamp){showTimestamp(timestamp)})},Alternatives=function(){var stringOne="",stringTwo="",stringThree="";this.clearString=function(){stringOne="",stringTwo="",stringThree=""},this.showAlternatives=function(alternatives){var $hypotheses=$(".hypotheses ol");$hypotheses.empty(),alternatives.forEach(function(alternative,idx){var $alternative;if(alternative.transcript){var transcript=alternative.transcript.replace(/%HESITATION\s/g,"");switch(transcript=transcript.replace(/(.)\1{2,}/g,""),idx){case 0:stringOne+=transcript,$alternative=$("<li data-hypothesis-index="+idx+" >"+stringOne+"</li>");break;case 1:stringTwo+=transcript,$alternative=$("<li data-hypothesis-index="+idx+" >"+stringTwo+"</li>");break;case 2:stringThree+=transcript,$alternative=$("<li data-hypothesis-index="+idx+" >"+stringThree+"</li>")}$hypotheses.append($alternative)}})}},alternativePrototype=new Alternatives;exports.showJSON=function(msg,baseJSON){var json=JSON.stringify(msg,null,2);return baseJSON+=json,baseJSON+="\n","JSON"===$(".nav-tabs .active").text()&&($("#resultsJSON").append(baseJSON),baseJSON="",console.log("updating json")),baseJSON};var initTextScroll=function(){$("#resultsText").on("scroll",function(){textScrolled=!0})},initScroll=function(){$(".table-scroll").on("scroll",function(){scrolled=!0})};exports.initDisplayMetadata=function(){initScroll(),initTextScroll()},exports.showResult=function(msg,baseString,model){if(msg.results&&msg.results.length>0){var alternatives=msg.results[0].alternatives,text=msg.results[0].alternatives[0].transcript||"";if(text=text.replace(/%HESITATION\s/g,""),text=text.replace(/(.)\1{2,}/g,""),msg.results[0]["final"]&&console.log("msg.results"),console.log("msg.results"),console.log("msg.results"),console.log("msg.results"),console.log("-> "+text),console.log("msg.results"),console.log("msg.results"),console.log("msg.results"),console.log("msg.results"),text=text.replace(/D_[^\s]+/g,""),0===text.length||/^\s+$/.test(text))return baseString;var japanese="ja-JP"===model.substring(0,5)||"zh-CN"===model.substring(0,5);msg.results&&msg.results[0]&&msg.results[0]["final"]?(text=text.slice(0,-1),text=text.charAt(0).toUpperCase()+text.substring(1),japanese?(text=text.trim()+"。",text=text.replace(/ /g,"")):text=text.trim()+". ",baseString+=text,$("#resultsText").val(baseString),showMetaData(alternatives[0]),alternativePrototype.showAlternatives(alternatives)):(text=japanese?text.replace(/ /g,""):text.charAt(0).toUpperCase()+text.substring(1),$("#resultsText").val(baseString+text))}return updateScroll(),updateTextScroll(),baseString},$.subscribe("clearscreen",function(){var $hypotheses=$(".hypotheses ul");scrolled=!1,$hypotheses.empty(),alternativePrototype.clearString()})},{}],5:[function(require,module,exports){"use strict";{var initSocket=require("./socket").initSocket;require("./displaymetadata")}exports.handleMicrophone=function(token,model,mic,callback){function onOpen(socket){console.log("Mic socket: opened"),callback(null,socket)}function onListening(socket){mic.onAudio=function(blob){socket.readyState<2&&socket.send(blob)}}function onMessage(msg){if(msg.results){var text=(msg.results[0].alternatives,msg.results[0].alternatives[0].transcript||"");text=text.replace(/%HESITATION\s/g,""),text=text.replace(/(.)\1{2,}/g,""),msg.results[0]["final"]&&(console.log("msg.results"),console.log("-> "+text),console.log("msg.results"),mic.message=text)}}function onError(){console.log("Mic socket err: ",err)}function onClose(evt){console.log("Mic socket close: ",evt)}if(model.indexOf("Narrowband")>-1){var err=new Error("Microphone transcription cannot accomodate narrowband models, please select another");return callback(err,null),!1}$.publish("clearscreen");var baseJSON="";$.subscribe("showjson",function(){var $resultsJSON=$("#resultsJSON");$resultsJSON.empty(),$resultsJSON.append(baseJSON)});var options={};options.token=token,options.message={action:"start","content-type":"audio/l16;rate=16000",interim_results:!0,continuous:!0,word_confidence:!0,timestamps:!0,max_alternatives:3,inactivity_timeout:600},options.model=model,initSocket(options,onOpen,onListening,onMessage,onError,onClose)}},{"./displaymetadata":4,"./socket":10}],6:[function(require,module,exports){"use strict";var selectModel=require("./selectmodel").initSelectModel;exports.getModels=function(token){var viewContext={currentModel:"en-US_BroadbandModel",models:null,token:token,bufferSize:BUFFERSIZE},modelUrl="https://stream.watsonplatform.net/speech-to-text/api/v1/models",sttRequest=new XMLHttpRequest;sttRequest.open("GET",modelUrl,!0),sttRequest.withCredentials=!0,sttRequest.setRequestHeader("Accept","application/json"),sttRequest.setRequestHeader("X-Watson-Authorization-Token",token),sttRequest.onload=function(){var response=JSON.parse(sttRequest.responseText),sorted=response.models.sort(function(a,b){return a.name>b.name?1:a.name<b.name?-1:0});response.models=sorted,localStorage.setItem("models",JSON.stringify(response.models)),viewContext.models=response.models,selectModel(viewContext)},sttRequest.onerror=function(){viewContext.models=require("./data/models.json").models,selectModel(viewContext)},sttRequest.send()}},{"./data/models.json":3,"./selectmodel":8}],7:[function(require,module,exports){"use strict";var Microphone=require("./Microphone"),handleMicrophone=require("./handlemicrophone").handleMicrophone,Voice=require("../Voice"),utils=require("./utils");exports.initRecordButton=function(ctx){var mic,recordButton=$("#recordButton"),timeoutId=0,running=!1;recordButton.mousedown(function(){var audio=$(".audio").get(0);audio.ended&&(timeoutId=setTimeout(handleRecord,1e3))}).bind("mouseup mouseleave",function(){clearTimeout(timeoutId)});var handleRecord=function(){running=!0;var token=ctx.token,micOptions={bufferSize:ctx.buffersize};return mic=new Microphone(micOptions),function(){{var currentModel=localStorage.getItem("currentModel");localStorage.getItem("currentlyDisplaying")}$("#resultsText").val(""),handleMicrophone(token,currentModel,mic,function(err){if(err){"Error: "+err.message}else recordButton.css("background-color","#d74108"),recordButton.find("img").attr("src","images/stop.svg"),$("#hold-span").css("display","none"),$("#speaking-span").css("display","initial"),console.log("starting mic"),mic.record()})}()};recordButton.mouseup(function(){running&&(recordButton.removeAttr("style"),recordButton.find("img").attr("src","images/microphone.svg"),$("#hold-span").css("display","initial"),$("#speaking-span").css("display","none"),setTimeout(function(){console.log("Stopping microphone, sending stop action message"),$.publish("hardsocketstop"),mic.stop();var voice=new Voice;if(mic.message){var text=FLOW_LIST[FLOW_POSITION][0],spokenText=FLOW_LIST[FLOW_POSITION][1];FLOW_POSITION+=1}else var text="I'm sorry. <br> Can you please repeat that?",spokenText="I'm ^200 sorry. ^500 Can ^50 you ^50 please ^50 repeat that?";voice.synthesizeRequest(text),utils.typeText(spokenText),running=!1},1e3))})}},{"../Voice":1,"./Microphone":2,"./handlemicrophone":5,"./utils":11}],8:[function(require,module,exports){"use strict";exports.initSelectModel=function(ctx){ctx.models.forEach(function(model){$("#dropdownMenuList").append($("<li>").attr("role","presentation").append($("<a>").attr("role","menu-item").attr("href","/").attr("data-model",model.name).append(model.description.substring(0,model.description.length-1),8e3==model.rate?" (8KHz)":" (16KHz)")))}),$("#dropdownMenuList").click(function(evt){evt.preventDefault(),evt.stopPropagation(),console.log("Change view",$(evt.target).text());var newModelDescription=$(evt.target).text(),newModel=$(evt.target).data("model");$("#dropdownMenuDefault").empty().text(newModelDescription),$("#dropdownMenu1").dropdown("toggle"),localStorage.setItem("currentModel",newModel),ctx.currentModel=newModel,$.publish("clearscreen")})}},{}],9:[function(require,module,exports){"use strict";exports.initSessionPermissions=function(){console.log("Initializing session permissions handler");var sessionPermissionsRadio=$("#sessionPermissionsRadioGroup input[type='radio']");sessionPermissionsRadio.click(function(){var checkedValue=sessionPermissionsRadio.filter(":checked").val();console.log("checkedValue",checkedValue),localStorage.setItem("sessionPermissions",checkedValue)})}},{}],10:[function(require,module,exports){"use strict";var utils=require("./utils"),tokenGenerator=utils.createTokenGenerator(),initSocket=exports.initSocket=function(options,onopen,onlistening,onmessage,onerror,onclose){function withDefault(val,defaultVal){return"undefined"==typeof val?defaultVal:val}var listening,socket,token=options.token,model=options.model||localStorage.getItem("currentModel"),message=options.message||{action:"start"},url=(withDefault(options.sessionPermissions,JSON.parse(localStorage.getItem("sessionPermissions"))),options.serviceURI||"wss://stream.watsonplatform.net/speech-to-text/api/v1/recognize?watson-token=");url+=token+"&model="+model,console.log("URL model",model);try{socket=new WebSocket(url)}catch(err){console.error("WS connection error: ",err)}socket.onopen=function(){listening=!1,$.subscribe("hardsocketstop",function(){console.log("MICROPHONE: close."),socket.send(JSON.stringify({action:"stop"})),socket.close()}),$.subscribe("socketstop",function(){console.log("MICROPHONE: close."),socket.close()}),socket.send(JSON.stringify(message)),onopen(socket)},socket.onmessage=function(evt){var msg=JSON.parse(evt.data);return msg.error?void $.publish("hardsocketstop"):("listening"===msg.state&&(listening?(console.log("MICROPHONE: Closing socket."),socket.close()):(onlistening(socket),listening=!0)),void onmessage(msg,socket))},socket.onerror=function(evt){console.log("WS onerror: ",evt),$.publish("clearscreen"),onerror(evt)},socket.onclose=function(evt){if(console.log("WS onclose: ",evt),1006===evt.code){if(console.log("generator count",tokenGenerator.getCount()),tokenGenerator.getCount()>1)throw $.publish("hardsocketstop"),new Error("No authorization token is currently available");return tokenGenerator.getToken(function(err,token){return err?($.publish("hardsocketstop"),!1):(console.log("Fetching additional token..."),options.token=token,void initSocket(options,onopen,onlistening,onmessage,onerror,onclose))}),!1}return 1011===evt.code?(console.error("Server error "+evt.code+": please refresh your browser and try again"),!1):evt.code>1e3?(console.error("Server error "+evt.code+": please refresh your browser and try again"),!1):($.unsubscribe("hardsocketstop"),$.unsubscribe("socketstop"),void onclose(evt))}}},{"./utils":11}],11:[function(require,module,exports){(function(global){"use strict";var $="undefined"!=typeof window?window.jQuery:"undefined"!=typeof global?global.jQuery:null,fileBlock=function(_offset,length,_file,readChunk){var r=new FileReader,blob=_file.slice(_offset,length+_offset);r.onload=readChunk,r.readAsArrayBuffer(blob)};exports.onFileProgress=function(options,ondata,running,onerror,onend,samplingRate){var file=options.file,fileSize=file.size,chunkSize=options.bufferSize||16e3,offset=0,readChunk=function(evt){if(offset>=fileSize)return console.log("Done reading file"),void onend();if(running()){if(null!=evt.target.error){var errorMessage=evt.target.error;return console.log("Read error: "+errorMessage),void onerror(errorMessage)}var buffer=evt.target.result,len=buffer.byteLength;offset+=len,ondata(buffer),samplingRate?setTimeout(function(){fileBlock(offset,chunkSize,file,readChunk)},1e3*chunkSize/(2*samplingRate)):fileBlock(offset,chunkSize,file,readChunk)}};fileBlock(offset,chunkSize,file,readChunk)},exports.createTokenGenerator=function(){var hasBeenRunTimes=0;return{getToken:function(callback){if(++hasBeenRunTimes,hasBeenRunTimes>5){var err=new Error("Cannot reach server");return void callback(null,err)}var url="/api/token",tokenRequest=new XMLHttpRequest;tokenRequest.open("POST",url,!0),tokenRequest.setRequestHeader("csrf-token",$('meta[name="ct"]').attr("content")),tokenRequest.onreadystatechange=function(){if(4===tokenRequest.readyState)if(200===tokenRequest.status){var token=tokenRequest.responseText;callback(null,token)}else{var error="Cannot reach server";if(tokenRequest.responseText)try{error=JSON.parse(tokenRequest.responseText)}catch(e){error=tokenRequest.responseText}callback(error)}},tokenRequest.send()},getCount:function(){return hasBeenRunTimes}}},exports.initPubSub=function(){var o=$({});$.subscribe=o.on.bind(o),$.unsubscribe=o.off.bind(o),$.publish=o.trigger.bind(o)},exports.typeText=function(text){for(var list=document.getElementById("textArea");list.hasChildNodes();)list.removeChild(list.firstChild);var span=document.createElement("SPAN");span.className+="spokenText",list.appendChild(span),$(".spokenText").typed({strings:[text],showCursor:!0,startDelay:750,backSpeed:-25})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(require,module,exports){"use strict";var initSessionPermissions=require("./sessionpermissions").initSessionPermissions,initRecordButton=require("./recordbutton").initRecordButton,initDisplayMetadata=require("./displaymetadata").initDisplayMetadata;exports.initViews=function(ctx){console.log("Initializing views..."),initRecordButton(ctx),initSessionPermissions(),initDisplayMetadata()}},{"./displaymetadata":4,"./recordbutton":7,"./sessionpermissions":9}],13:[function(require){"use strict";var models=require("../public/js/microphone/data/models.json").models,utils=require("../public/js/microphone/utils.js");utils.initPubSub();var initViews=require("../public/js/microphone/views.js").initViews,getModels=require("../public/js/microphone/models.js").getModels,Voice=require("../public/js/Voice");window.BUFFERSIZE=8192,$(document).ready(function(){var voice=new Voice,text="Hi, my name is Allison. <br> What is your name?",spokenText="Hi, ^200 my ^200 name ^200 is ^200 Allison. ^200 What ^50 is ^50 your ^50 name?";voice.synthesizeRequest(text),utils.typeText(spokenText);var tokenGenerator=utils.createTokenGenerator();tokenGenerator.getToken(function(err,token){window.onbeforeunload=function(){localStorage.clear()},token||(console.error("No authorization token available"),console.error("Attempting to reconnect..."));var viewContext={currentModel:"en-US_BroadbandModel",models:models,token:token,bufferSize:BUFFERSIZE};initViews(viewContext),localStorage.setItem("models",JSON.stringify(models)),localStorage.setItem("playbackON",!1);for(var query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");"debug"===decodeURIComponent(pair[0])&&localStorage.setItem("playbackON",decodeURIComponent(pair[1]))}localStorage.setItem("currentModel","en-US_BroadbandModel"),localStorage.setItem("sessionPermissions","true"),getModels(token)})})},{"../public/js/Voice":1,"../public/js/microphone/data/models.json":3,"../public/js/microphone/models.js":6,"../public/js/microphone/utils.js":11,"../public/js/microphone/views.js":12}]},{},[13]);